# DecodeUTF8toSJIS_forMSX

MSX BASICでUTF8テキストファイルをShiftJISに変換し表示するプログラムです。  

内部の仕組みは...  
UTF-8の文字の内、MSXで使用できるASCII文字コード1~127番と、ShiftJISの文字が格納されている3バイト文字の変換をしています。  
2/4/6バイト文字は、MSXでは表示ができない（はず）ので無視しています。  
  
3バイトの解析は、1110yyyy 10yyyyxx 10xxxxxxのビット列になっている3バイトからy8ビットとx8ビットの16ビットを抽出して数値化し、それをレコード番号とし、変換テーブルのUTF8SJIS.txtから読み取り、文字を取り出しています。  
UTF8SJIS.txtは、メンテナンス性重視で1レコード4バイト(SJIS文字2バイトとCR/LF）の1行とし、行番号が16ビット数値として見れるようにしてます。  
そのため、変換テーブルのサイズが262,140 バイトと少々大きくなっています。  
  
ディスクアクセスが頻繁になるため、FDDでの使用は想定しておらず、MSX0や1chipMSXのSDカード、もしくはRAMディスクでの使用をお勧めします。  
  
変換テーブルは、ネットで調べたものを変換してデータ化していますが、全て網羅できていない可能性もありますので、その場合は、上記ルールでテーブルをメンテナンスするか、Xの@ikaten_retro までご連絡ください。  

